<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cafe">

	<!-- 카페 추가 -->
	<insert id="addCafe" parameterType="com.nextroom.vo.CafeVo">
		<![CDATA[
			insert into cafe
			values (cafeNo.nextval, 
					#{userNo}, 
					#{cafeName}, 
					#{cafeHp}, 
					#{openTime}, 
					#{closeTime}, 
					#{cafeIntro}, 
					#{url}, 
					#{cafeImg}, 
					#{address}, 
					#{sido}, 
					#{sidoDetail})
		]]>
	</insert>

	<!-- 카페 추가 및 카페번호 가져오기 -->
	<insert id="addCafeKey" parameterType="com.nextroom.vo.CafeVo">
		<selectKey keyProperty="cafeNo" resultType="int" order="BEFORE">
			select cafeNo.nextval from dual
		</selectKey>
		<![CDATA[	
			insert into cafe
				values (#{cafeNo}, 
						#{userNo}, 
						#{cafeName}, 
						#{cafeHp}, 
						#{openTime}, 
						#{closeTime}, 
						#{cafeIntro}, 
						#{url}, 
						#{cafeImg}, 
						#{printAddress}, 
						#{sido}, 
						#{sidoDetail})
	    	]]>
	</insert>



	<!-- 카페 수정 -->
	<update id="updateCafe" parameterType="com.nextroom.vo.CafeVo">
	
		<![CDATA[
				update cafe
				set cafeImg = #{cafeImg}
					
				where cafeNo = #{no}
			]]>

	</update>
	
	
	<!-- 유저 타입 수정 -->
	<update id="updateUser" parameterType="int">
		<![CDATA[
				update users
				set userType = 2
				where userNo = #{userNo}
			]]>
	</update>

	<!-- 카페 내부이미지 추가 -->
	<insert id="addInteriorImg" parameterType="Map"> 
		<![CDATA[ 
				insert into interiorImg 
				values (
						#{cafeNo},
						#{intePath}
				) ]]>
	</insert>
	
	<!-- 카페 한개 정보 가져오기 -->
	<select id="getCafe" parameterType="int" resultType="com.nextroom.vo.CafeVo">
		<![CDATA[
			select cafeName, cafeHp, openTime, closeTime, 
				   cafeIntro, url, cafeImg, address, addressDetail, sido, sidoDetail
			from cafe
			where #{cafeNo}
			
		
		]]>
	
	</select>

</mapper>